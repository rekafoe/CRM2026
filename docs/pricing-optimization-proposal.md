# –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ —Ü–µ–Ω

## –¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞

**–¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
service_volume_prices:
  - id
  - service_id
  - variant_id (–¥–ª—è –≤–∞—Ä–∏–∞–Ω—Ç–∞)
  - min_quantity (–≥—Ä–∞–Ω–∏—Ü–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞)
  - price_per_unit (—Ü–µ–Ω–∞ –¥–ª—è —ç—Ç–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞)
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
1. ‚ùå **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**: –î–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Ö—Ä–∞–Ω—è—Ç—Å—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ (min_quantity)
2. ‚ùå **–ú–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ü–∏–π**: –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã (50+ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ √ó 7 –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ = 350+ —Å—Ç—Ä–æ–∫)
3. ‚ùå **–°–ª–æ–∂–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**: –ù—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å tiers –º–µ–∂–¥—É –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏
4. ‚ùå **–†–µ—Å—É—Ä—Å–æ–∑–∞—Ç—Ä–∞—Ç–Ω–æ**: –ú–Ω–æ–≥–æ DELETE/INSERT –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤

## –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–†–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã:**

```sql
-- –û–±—â–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞ (–æ–¥–∏–Ω —Ä–∞–∑ –Ω–∞ —Å–µ—Ä–≤–∏—Å)
CREATE TABLE service_range_boundaries (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  service_id INTEGER NOT NULL,
  min_quantity INTEGER NOT NULL,
  sort_order INTEGER DEFAULT 0,
  is_active INTEGER DEFAULT 1,
  created_at TEXT DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY(service_id) REFERENCES post_processing_services(id) ON DELETE CASCADE,
  UNIQUE(service_id, min_quantity)
);

-- –¶–µ–Ω—ã –ø–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º (—Ç–æ–ª—å–∫–æ —Ü–µ–Ω—ã, –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –≥—Ä–∞–Ω–∏—Ü)
CREATE TABLE service_variant_prices (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  variant_id INTEGER NOT NULL,
  range_id INTEGER NOT NULL,  -- —Å—Å—ã–ª–∫–∞ –Ω–∞ service_range_boundaries
  price_per_unit REAL NOT NULL,
  is_active INTEGER DEFAULT 1,
  created_at TEXT DEFAULT CURRENT_TIMESTAMP,
  updated_at TEXT DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY(variant_id) REFERENCES service_variants(id) ON DELETE CASCADE,
  FOREIGN KEY(range_id) REFERENCES service_range_boundaries(id) ON DELETE CASCADE,
  UNIQUE(variant_id, range_id)
);
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ **–ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è**: –ì—Ä–∞–Ω–∏—Ü—ã –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ —Ö—Ä–∞–Ω—è—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑
- ‚úÖ **–ë—ã—Å—Ç—Ä–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ**: –ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ = 1 DELETE/INSERT –≤–º–µ—Å—Ç–æ 50+
- ‚úÖ **–ü—Ä–æ—Å—Ç–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ foreign key
- ‚úÖ **–ú–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö**: –î–ª—è 50 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ √ó 7 –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤: 7 —Å—Ç—Ä–æ–∫ –≥—Ä–∞–Ω–∏—Ü + 350 —Å—Ç—Ä–æ–∫ —Ü–µ–Ω (–≤–º–µ—Å—Ç–æ 350 —Å—Ç—Ä–æ–∫ —Å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º)

**–ü—Ä–∏–º–µ—Ä:**
```
–î–æ: 50 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ √ó 7 –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ = 350 —Å—Ç—Ä–æ–∫ –≤ service_volume_prices
–ü–æ—Å–ª–µ: 7 —Å—Ç—Ä–æ–∫ –≤ service_range_boundaries + 350 —Å—Ç—Ä–æ–∫ –≤ service_variant_prices = 357 —Å—Ç—Ä–æ–∫
–ù–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–∞: 1 –æ–ø–µ—Ä–∞—Ü–∏—è –≤–º–µ—Å—Ç–æ 350!
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: JSON —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ü–µ–Ω

```sql
-- –í–∞—Ä–∏–∞–Ω—Ç—ã —Å —Ü–µ–Ω–∞–º–∏ –≤ JSON
ALTER TABLE service_variants ADD COLUMN prices_json TEXT;

-- –ü—Ä–∏–º–µ—Ä: prices_json = '{"1000": 10.5, "2000": 9.5, "5000": 8.5}'
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ–µ —á—Ç–µ–Ω–∏–µ (–æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å)
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ (–æ–¥–∏–Ω UPDATE)

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –°–ª–æ–∂–Ω–µ–µ –∑–∞–ø—Ä–æ—Å—ã (–Ω—É–∂–µ–Ω JSON_EXTRACT)
- ‚ùå –ù–µ—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚ùå –°–ª–æ–∂–Ω–µ–µ –≤–∞–ª–∏–¥–∞—Ü–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥

–•—Ä–∞–Ω–∏—Ç—å –æ–±—â–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã –æ—Ç–¥–µ–ª—å–Ω–æ, –Ω–æ —Ü–µ–Ω—ã –≤ JSON –ø–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º:

```sql
-- –û–±—â–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã
CREATE TABLE service_range_boundaries (...);

-- –¶–µ–Ω—ã –≤ JSON –ø–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º
ALTER TABLE service_variants ADD COLUMN prices_json TEXT;
-- –ü—Ä–∏–º–µ—Ä: '{"1": 10.5, "2": 9.5}' –≥–¥–µ –∫–ª—é—á = range_id
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–í—ã–±—Ä–∞—Ç—å –í–∞—Ä–∏–∞–Ω—Ç 1 (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)** –ø–æ—Ç–æ–º—É —á—Ç–æ:
1. ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∞–º –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î
2. ‚úÖ –õ–µ–≥–∫–æ –¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∏ –∏–Ω–¥–µ–∫—Å—ã
3. ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
4. ‚úÖ –õ–µ–≥–∫–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ

## –ú–∏–≥—Ä–∞—Ü–∏—è

1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã
2. –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ:
   - –ò–∑–≤–ª–µ—á—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ min_quantity ‚Üí service_range_boundaries
   - –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Ü–µ–Ω—ã ‚Üí service_variant_prices —Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ range_id
3. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
4. –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—É—é —Ç–∞–±–ª–∏—Ü—É service_volume_prices (–∏–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)

## –û—Ü–µ–Ω–∫–∞ –≤—ã–∏–≥—Ä—ã—à–∞

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞: ~350 DELETE + ~350 INSERT = ~700 –æ–ø–µ—Ä–∞—Ü–∏–π
- –í—Ä–µ–º—è: ~7-10 —Å–µ–∫—É–Ω–¥

**–ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞: 1 DELETE + 1 INSERT = 2 –æ–ø–µ—Ä–∞—Ü–∏–∏
- –í—Ä–µ–º—è: ~0.02 —Å–µ–∫—É–Ω–¥—ã

**–£—Å–∫–æ—Ä–µ–Ω–∏–µ: ~350x** üöÄ
