# üìã –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–π –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î

## üéØ –¶–µ–ª—å
–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –º–∏–≥—Ä–∞—Ü–∏–π –Ω–∞ TypeScript, –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ –∏ –∑–∞—à–∏—Ç—ã—Ö —Å–∏–¥–æ–≤.

---

## üîç –ß—Ç–æ –±—ã–ª–æ –Ω–µ —Ç–∞–∫ —Ä–∞–Ω—å—à–µ

- –î–µ—Å—è—Ç–∫–∏ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –º–∏–≥—Ä–∞—Ü–∏–π –≤ —Ä–∞–∑–Ω—ã—Ö –ø–∞–ø–∫–∞—Ö (`migrations/`, `src/migrations/`).
- –¢—è–∂—ë–ª—ã–π `db.ts`, –∫–æ—Ç–æ—Ä—ã–π –≤—Ä—É—á–Ω—É—é —Å–æ–∑–¥–∞–≤–∞–ª —Ç–∞–±–ª–∏—Ü—ã, –¥–æ–±–∞–≤–ª—è–ª –∫–æ–ª–æ–Ω–∫–∏ –∏ –Ω–∞–ø–æ–ª–Ω—è–ª –ë–î –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
- –°–º–µ—à–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (`.js` –∏ `.ts`), –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –µ–¥–∏–Ω–æ–≥–æ —Å—Ç–∏–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞.
- –ù–µ–æ—á–µ–≤–∏–¥–Ω—ã–π —Å–ø–æ—Å–æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ö–µ–º—ã (–Ω—É–∂–Ω–æ –±—ã–ª–æ –∑–∞–ø—É—Å–∫–∞—Ç—å `db:init`, `db:reset`, etc.).

---

## ‚úÖ –ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ (—É–∂–µ –≤ –∫–æ–¥–µ)

1. **TypeScript‚Äë–º–∏–≥—Ä–∞—Ü–∏–∏**
   - –í `src/migrations` —Ö—Ä–∞–Ω–∏–º –º–∏–≥—Ä–∞—Ü–∏–∏ —Ñ–æ—Ä–º–∞—Ç–∞ `YYYYMMDDHHmmss_description.ts`.
   - –ë–∞–∑–æ–≤–∞—è –º–∏–≥—Ä–∞—Ü–∏—è `20240101000000_initial_schema.ts` –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å—Ç–∞—Ä—Ç–æ–≤—É—é —Å—Ö–µ–º—É.
   - –ù–æ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏. –ü—Ä–∏–º–µ—Ä: `20250131000004_add_missing_material_fields.ts` –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∫–æ–ª–æ–Ω–∫–∏ –≤ `materials` —á–µ—Ä–µ–∑ `PRAGMA table_info`.

2. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ `initDB()`**
   - –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –¥–æ—Å—Ç—É–ø–µ `initDB()` –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ SQLite, –≤–∫–ª—é—á–∞–µ—Ç `PRAGMA foreign_keys` –∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏.
   - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ –≤—Ä–æ–¥–µ `db:init` –±–æ–ª—å—à–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.
   - –î–ª—è —Å—Ç–∞—Ä—ã—Ö –±–∞–∑ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω –±–µ–∑–æ–ø–∞—Å–Ω—ã–π `migrateLegacyMaterialMoves()`, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–≤–æ–¥–∏—Ç —Ç–∞–±–ª–∏—Ü—É `material_moves` –¥–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –≤–∏–¥–∞ (–Ω–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏, –∏–Ω–¥–µ–∫—Å—ã).

3. **–î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã**
   - –í `package.json` –¥–æ–±–∞–≤–ª–µ–Ω —Å–∫—Ä–∏–ø—Ç `npm run seed:demo`, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç `src/scripts/seedDemoData.ts`.
   - –°–∫—Ä–∏–ø—Ç –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–µ–Ω: –æ–Ω –Ω–µ –¥—É–±–ª–∏—Ä—É–µ—Ç –∑–∞–ø–∏—Å–∏, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç.
   - –¢–µ–ø–µ—Ä—å –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–¥–º–µ—à–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ –ø—Ä–æ–¥/—Ç–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ.

---

## üß≠ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞–±–æ—Ç–µ

### –ù–æ–≤–∞—è –±–∞–∑–∞ (–ª–æ–∫–∞–ª—å–Ω–æ –∏–ª–∏ CI)
```bash
npm install
npm run dev              # initDB –≤—ã–∑–æ–≤–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
npm run seed:demo        # —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω—É–∂–Ω—ã –¥–µ–º–æ-–∑–∞–ø–∏—Å–∏
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –±–∞–∑—ã
1. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å ‚Äî `initDB()` –ø—Ä–æ–≥–æ–Ω–∏—Ç –Ω–æ–≤—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏.
2. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤—Ä—É—á–Ω—É—é –≤—ã–ø–æ–ª–Ω–∏—Ç—å `npm run seed:demo` (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–ø–æ–ª–Ω–∏—Ç—å —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏).

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏
1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `src/migrations/YYYYMMDDHHmmss_description.ts`.
2. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å `async function up(db: Database)` (–∏ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ `down`).
3. –í `up` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `PRAGMA table_info`/`ADD COLUMN IF NOT EXISTS`‚Äë–ø–∞—Ç—Ç–µ—Ä–Ω, —á—Ç–æ–±—ã –º–∏–≥—Ä–∞—Ü–∏—è –±—ã–ª–∞ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ–π.
4. –ó–∞–ø—É—Å—Ç–∏—Ç—å `npm test` ‚Äî –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ —Ç–µ—Å—Ç–æ–≤–æ–π –±–∞–∑–µ –ø–µ—Ä–µ–¥ –ø—Ä–æ–≥–æ–Ω–æ–º.

---

## üì¶ –ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å–æ —Å—Ç–∞—Ä—ã–º–∏ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏

- –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ `.sql/.js` —Ñ–∞–π–ª—ã –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –∏–ª–∏ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ `archive/`, —Ç–∞–∫ –∫–∞–∫ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫—É—é —Å—Ö–µ–º—É —Ç–µ–ø–µ—Ä—å –∑–∞–¥–∞—ë—Ç `20240101000000_initial_schema.ts` –∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ TS‚Äë–º–∏–≥—Ä–∞—Ü–∏–∏.
- –ï—Å–ª–∏ –Ω—É–∂–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å—Ç–∞—Ä—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å git‚Äë–∏—Å—Ç–æ—Ä–∏—é –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç `docs/database-history.md`.

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- `npm test` –ø–æ–¥–Ω–∏–º–∞–µ—Ç in-memory/–≤—Ä–µ–º–µ–Ω–Ω—É—é SQLite, –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –ø—Ä–æ–≥–æ–Ω—è–µ—Ç Jest.
- –ï—Å–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è –º–∏–≥—Ä–∞—Ü–∏—è, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–æ –∫–æ–º–º–∏—Ç–∞ ‚Äî —ç—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ `initDB` –Ω–µ —Å–ª–æ–º–∞–µ—Ç—Å—è –Ω–∞ —á–∏—Å—Ç–æ–π –±–∞–∑–µ.

---

## üìò –°–≤–æ–¥–∫–∞

| –í–æ–ø—Ä–æ—Å | –ë—ã–ª–æ | –°—Ç–∞–ª–æ |
|--------|------|-------|
| –•—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ö–µ–º—ã | –í—Ä—É—á–Ω—É—é –≤ `db.ts` + SQL —Ñ–∞–π–ª—ã | –ú–∏–≥—Ä–∞—Ü–∏–∏ TypeScript + `initDB()` |
| –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ | –ü–æ–¥–º–µ—à–∏–≤–∞–ª–∏—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ | `npm run seed:demo` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |
| –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —Ç–∞–±–ª–∏—Ü | –ü–∞–∫–µ—Ç `ALTER` –≤ `db.ts` | –¢–æ—á–µ—á–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (`20250131000004...`) |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | –£—Å—Ç–∞—Ä–µ–ª–∞ | README –∏ —ç—Ç–æ—Ç –ø–ª–∞–Ω –æ–±–Ω–æ–≤–ª–µ–Ω—ã |

**–ò—Ç–æ–≥:** —Å—Ö–µ–º–∞ –ø–æ–¥–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞, initDB —á–∏—Å—Ç—ã–π, —Å–∏–¥—ã —Ä—É—á–Ω—ã–µ, –º–∏–≥—Ä–∞—Ü–∏–∏ –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã. –î–∞–ª—å—à–µ ‚Äî —Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ `YYYYMMDD...` —Ñ–∞–π–ª—ã –∏ –¥–µ—Ä–∂–∞—Ç—å —Ç–µ—Å—Ç—ã –∑–µ–ª—ë–Ω—ã–º–∏.

