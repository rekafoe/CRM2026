# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ "Cannot read properties of null (reading 'attrib')"

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ Excel –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏–∑ —à–∞–±–ª–æ–Ω–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞:
```
Error: –û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ Excel –¥–æ–∫—É–º–µ–Ω—Ç–∞: Cannot read properties of null (reading 'attrib')
```

## –ü—Ä–∏—á–∏–Ω–∞

–≠—Ç–∞ –æ—à–∏–±–∫–∞ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ `xlsx-template` –æ–±—ã—á–Ω–æ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç, –∫–æ–≥–¥–∞:
1. –í —à–∞–±–ª–æ–Ω–µ –µ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–ª–∏ –¥—Ä—É–≥–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –Ω–µ –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å
2. –®–∞–±–ª–æ–Ω –±—ã–ª —Å–æ–∑–¥–∞–Ω –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ (—á–µ—Ä–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫—É `xlsx`), –∞ –Ω–µ –≤—Ä—É—á–Ω—É—é –≤ Excel
3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —à–∞–±–ª–æ–Ω–∞ –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å `xlsx-template`

## –†–µ—à–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –°–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω –≤—Ä—É—á–Ω—É—é –≤ Excel (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –û—Ç–∫—Ä–æ–π—Ç–µ Excel
2. –°–æ–∑–¥–∞–π—Ç–µ —à–∞–±–ª–æ–Ω —Å –Ω—É–∂–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
3. –í—Å—Ç–∞–≤—å—Ç–µ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –≤ —è—á–µ–π–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `${legalName}`, `${totalAmount}`)
4. –î–ª—è —Ç–∞–±–ª–∏—Ü –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å:
   - –í –ø–µ—Ä–≤–æ–π —è—á–µ–π–∫–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ—Å–ª–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤: `${table:orderItems}`
   - –í —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–æ–∫–µ: –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –ø–æ–ª–µ–π `${number}`, `${name}`, –∏ —Ç.–¥.
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª –∫–∞–∫ `.xlsx`
6. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É

**–í–∞–∂–Ω–æ:** –ù–µ –¥–æ–±–∞–≤–ª—è–π—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, —Å–ª–æ–∂–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∏–ª–∏ –¥—Ä—É–≥–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω, —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç–æ–º

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —à–∞–±–ª–æ–Ω, —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç–æ–º `generateActTemplate.ts`:

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ñ–∞–π–ª `templates/act-template.xlsx` –≤ Excel
2. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –µ–≥–æ –∑–∞–Ω–æ–≤–æ (File ‚Üí Save As ‚Üí Excel Workbook)
3. –≠—Ç–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Å—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ñ–∞–π–ª–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ, –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ–º —Å Excel
4. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –≤ —Å–∏—Å—Ç–µ–º—É

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —à–∞–±–ª–æ–Ω–∞

–ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –≤—Å–µ –µ—â–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç:

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ —à–∞–±–ª–æ–Ω–µ –Ω–µ—Ç:
   - –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
   - –°–ª–æ–∂–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤
   - –ú–∞–∫—Ä–æ—Å–æ–≤
   - –°–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –Ω–∞–ø–∏—Å–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ:
   - `${fieldName}` - –ø—Ä–∞–≤–∏–ª—å–Ω–æ
   - `{fieldName}` - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (–Ω–µ—Ç –¥–æ–ª–ª–∞—Ä–∞)
   - `$fieldName` - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (–Ω–µ—Ç —Ñ–∏–≥—É—Ä–Ω—ã—Ö —Å–∫–æ–±–æ–∫)

3. –î–ª—è —Ç–∞–±–ª–∏—Ü —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è:
   ```
   | –ó–∞–≥–æ–ª–æ–≤–æ–∫ 1 | –ó–∞–≥–æ–ª–æ–≤–æ–∫ 2 | ... |
   | ${table:orderItems} | | |
   | ${number} | ${name} | ... |
   ```

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–∞–µ—Ç—Å—è, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É `xlsx-populate` –≤–º–µ—Å—Ç–æ `xlsx-template`, –Ω–æ —ç—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.

## –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —à–∞–±–ª–æ–Ω –≤ —Å–∏—Å—Ç–µ–º—É
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ –∫–∞–∫ —à–∞–±–ª–æ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

## –õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

–í –ª–æ–≥–∞—Ö —Å–µ—Ä–≤–µ—Ä–∞ –≤—ã —É–≤–∏–¥–∏—Ç–µ:
```
[DocumentTemplate] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Excel –∏–∑ —à–∞–±–ª–æ–Ω–∞: –ø—É—Ç—å/–∫/—Ñ–∞–π–ª—É.xlsx
[DocumentTemplate] –î–∞–Ω–Ω—ã–µ –¥–ª—è Excel —à–∞–±–ª–æ–Ω–∞: {...}
[DocumentTemplate] –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∫ —à–∞–±–ª–æ–Ω—É
[DocumentTemplate] Excel —Ñ–∞–π–ª —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω, —Ä–∞–∑–º–µ—Ä: X –±–∞–π—Ç
```

–ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∞, –æ–Ω–∞ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω–∞ —Å –¥–µ—Ç–∞–ª—è–º–∏.
