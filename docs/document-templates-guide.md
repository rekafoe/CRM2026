# üìÑ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —à–∞–±–ª–æ–Ω–∞–º –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (–¥–æ–≥–æ–≤–æ—Ä—ã, –∞–∫—Ç—ã, —Å—á–µ—Ç–∞). –í—ã –º–æ–∂–µ—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–≤–æ–π —à–∞–±–ª–æ–Ω –¥–æ–∫—É–º–µ–Ω—Ç–∞, –∏ —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –ø–æ–ª—è, —Å–æ—Ö—Ä–∞–Ω—è—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —à–∞–±–ª–æ–Ω–∞.

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

- **–î–æ–≥–æ–≤–æ—Ä—ã**: `.docx` (Word)
- **–ê–∫—Ç—ã –∏ –°—á–µ—Ç–∞**: `.xlsx` –∏–ª–∏ `.xls` (Excel)

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω—ã

### 1. –°–æ–∑–¥–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞ Word (–¥–ª—è –¥–æ–≥–æ–≤–æ—Ä–æ–≤)

1. –°–æ–∑–¥–∞–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç Word (`.docx`) —Å –Ω—É–∂–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
2. –í –º–µ—Å—Ç–∞—Ö, –≥–¥–µ –Ω—É–∂–Ω–æ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –≤ —Ñ–∏–≥—É—Ä–Ω—ã—Ö —Å–∫–æ–±–∫–∞—Ö:

```
–î–û–ì–û–í–û–† ‚Ññ {contractNumber}

–ö–ª–∏–µ–Ω—Ç: {customerName}
–Æ—Ä. –∞–¥—Ä–µ—Å: {legalAddress}
–£–ù–ü: {taxId}
–†–∞—Å—á—ë—Ç–Ω—ã–π —Å—á—ë—Ç –∏ –±–∞–Ω–∫: {bankDetails}
–£–ø–æ–ª–Ω–æ–º–æ—á–µ–Ω–Ω–æ–µ –ª–∏—Ü–æ: {authorizedPerson}
–î–∞—Ç–∞ –¥–æ–≥–æ–≤–æ—Ä–∞: {contractDate}
```

3. –î–ª—è —Ç–∞–±–ª–∏—Ü—ã –∑–∞–∫–∞–∑–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ü–∏–∫–ª:

```
{orders}
  –ó–∞–∫–∞–∑: {number}
  –î–∞—Ç–∞: {date}
  –°—É–º–º–∞: {amount}
  –°—Ç–∞—Ç—É—Å: {status}
{/orders}
```

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–ª—è –¥–ª—è –¥–æ–≥–æ–≤–æ—Ä–æ–≤:**
- `{customerName}` - –ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞
- `{companyName}` - –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏
- `{legalName}` - –Æ—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
- `{legalAddress}` - –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å
- `{taxId}` - –£–ù–ü
- `{bankDetails}` - –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã
- `{authorizedPerson}` - –£–ø–æ–ª–Ω–æ–º–æ—á–µ–Ω–Ω–æ–µ –ª–∏—Ü–æ
- `{contractNumber}` - –ù–æ–º–µ—Ä –¥–æ–≥–æ–≤–æ—Ä–∞
- `{contractDate}` - –î–∞—Ç–∞ –¥–æ–≥–æ–≤–æ—Ä–∞
- `{totalAmount}` - –û–±—â–∞—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–æ–≤
- `{orders}` - –ú–∞—Å—Å–∏–≤ –∑–∞–∫–∞–∑–æ–≤ (—Å–º. —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —Ü–∏–∫–ª–æ–≤ docxtemplater)

### 2. –°–æ–∑–¥–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞ Excel (–¥–ª—è –∞–∫—Ç–æ–≤ –∏ —Å—á–µ—Ç–æ–≤)

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª Excel (`.xlsx` –∏–ª–∏ `.xls`)
2. –í —è—á–µ–π–∫–∞—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ `${variableName}`:

| A | B |
|---|---|
| –ö–ª–∏–µ–Ω—Ç | ${customerName} |
| –£–ù–ü | ${taxId} |
| –û–±—â–∞—è —Å—É–º–º–∞ | ${totalAmount} |

3. –î–ª—è —Ç–∞–±–ª–∏—Ü –∑–∞–∫–∞–∑–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å `${table:orders}`:

| ‚Ññ | –î–∞—Ç–∞ | –ó–∞–∫–∞–∑ | –°—É–º–º–∞ | –°—Ç–∞—Ç—É—Å |
|---|---|---|---|---|
| ${table:orders} | | | | |
| ${number} | ${date} | ${number} | ${amount} | ${status} |

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–ª—è –¥–ª—è –∞–∫—Ç–æ–≤/—Å—á–µ—Ç–æ–≤:**
- `${customerName}` - –ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞
- `${companyName}` - –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏
- `${legalAddress}` - –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å
- `${taxId}` - –£–ù–ü
- `${bankDetails}` - –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã
- `${authorizedPerson}` - –£–ø–æ–ª–Ω–æ–º–æ—á–µ–Ω–Ω–æ–µ –ª–∏—Ü–æ
- `${contractNumber}` - –ù–æ–º–µ—Ä –¥–æ–≥–æ–≤–æ—Ä–∞
- `${contractDate}` - –î–∞—Ç–∞
- `${totalAmount}` - –û–±—â–∞—è —Å—É–º–º–∞
- `${table:orders}` - –¢–∞–±–ª–∏—Ü–∞ –∑–∞–∫–∞–∑–æ–≤ (—Å–º. –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é xlsx-template)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–±—ä–µ–∫—Ç–∞ –∑–∞–∫–∞–∑–∞ –≤ –º–∞—Å—Å–∏–≤–µ orders:**
```javascript
{
  number: string,    // –ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞
  date: string,     // –î–∞—Ç–∞ –∑–∞–∫–∞–∑–∞
  amount: number,    // –°—É–º–º–∞ –∑–∞–∫–∞–∑–∞
  status: string    // –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞
}
```

## –ó–∞–≥—Ä—É–∑–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤

### –ß–µ—Ä–µ–∑ API (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)

```javascript
const formData = new FormData();
formData.append('template', file);
formData.append('name', '–ú–æ–π —à–∞–±–ª–æ–Ω –¥–æ–≥–æ–≤–æ—Ä–∞');
formData.append('type', 'contract'); // 'contract' | 'act' | 'invoice'
formData.append('isDefault', 'true'); // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–∞–∫ —à–∞–±–ª–æ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

await uploadDocumentTemplate(formData);
```

### –ß–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)

–í –±—É–¥—É—â–µ–º –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —à–∞–±–ª–æ–Ω–∞–º–∏.

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —à–∞–±–ª–æ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞. –ï—Å–ª–∏ —à–∞–±–ª–æ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞.

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

1. **–®–∞–±–ª–æ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é** - –µ—Å–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω —à–∞–±–ª–æ–Ω —Å —Ñ–ª–∞–≥–æ–º `is_default = true`
2. **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è** - –µ—Å–ª–∏ —à–∞–±–ª–æ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω

## –ü—Ä–∏–º–µ—Ä—ã —à–∞–±–ª–æ–Ω–æ–≤

### –ü—Ä–∏–º–µ—Ä –¥–æ–≥–æ–≤–æ—Ä–∞ (Word)

```
–î–û–ì–û–í–û–† ‚Ññ {contractNumber}
–Ω–∞ –æ–∫–∞–∑–∞–Ω–∏–µ –ø–æ–ª–∏–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —É—Å–ª—É–≥

–î–∞—Ç–∞: {contractDate}

–ò–°–ü–û–õ–ù–ò–¢–ï–õ–¨:
–û–û–û "–ü–µ—á–∞—Ç–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è"
–£–ù–ü: 123456789
–ê–¥—Ä–µ—Å: –≥. –ú–∏–Ω—Å–∫, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, 1

–ó–ê–ö–ê–ó–ß–ò–ö:
{customerName}
–£–ù–ü: {taxId}
–ê–¥—Ä–µ—Å: {legalAddress}
–†–∞—Å—á—ë—Ç–Ω—ã–π —Å—á—ë—Ç: {bankDetails}
–£–ø–æ–ª–Ω–æ–º–æ—á–µ–Ω–Ω–æ–µ –ª–∏—Ü–æ: {authorizedPerson}

–ó–ê–ö–ê–ó–´:
{orders}
  –ó–∞–∫–∞–∑ {number} –æ—Ç {date} –Ω–∞ —Å—É–º–º—É {amount} BYN (–°—Ç–∞—Ç—É—Å: {status})
{/orders}

–ò–¢–û–ì–û: {totalAmount} BYN
```

### –ü—Ä–∏–º–µ—Ä –∞–∫—Ç–∞ (Excel)

| A | B | C |
|---|---|---|
| –ê–ö–¢ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç | | |
| | | |
| –ö–ª–∏–µ–Ω—Ç: | ${customerName} | |
| –£–ù–ü: | ${taxId} | |
| –î–∞—Ç–∞: | ${contractDate} | |
| | | |
| ‚Ññ | –î–∞—Ç–∞ | –ó–∞–∫–∞–∑ | –°—É–º–º–∞ | –°—Ç–∞—Ç—É—Å |
| ${table:orders} | | | | |
| ${number} | ${date} | ${number} | ${amount} | ${status} |
| | | | | |
| –ò–¢–û–ì–û: | | | ${totalAmount} | |

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏

- **Word —à–∞–±–ª–æ–Ω—ã**: `docxtemplater` + `pizzip`
- **Excel —à–∞–±–ª–æ–Ω—ã**: `xlsx-template`

### –•—Ä–∞–Ω–µ–Ω–∏–µ

- –®–∞–±–ª–æ–Ω—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `backend/templates/`
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `document_templates` –≤ –ë–î

### API Endpoints

- `GET /api/document-templates` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —à–∞–±–ª–æ–Ω—ã
- `GET /api/document-templates/type/:type` - –ü–æ–ª—É—á–∏—Ç—å —à–∞–±–ª–æ–Ω—ã –ø–æ —Ç–∏–ø—É
- `POST /api/document-templates` - –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–π —à–∞–±–ª–æ–Ω
- `POST /api/document-templates/:id/generate` - –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç –∏–∑ —à–∞–±–ª–æ–Ω–∞
- `POST /api/document-templates/generate/:type` - –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ —Ç–∏–ø—É (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç —à–∞–±–ª–æ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `PATCH /api/document-templates/:id/set-default` - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —à–∞–±–ª–æ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- `DELETE /api/document-templates/:id` - –£–¥–∞–ª–∏—Ç—å —à–∞–±–ª–æ–Ω

## –û—Ç–ª–∞–¥–∫–∞

–ï—Å–ª–∏ —à–∞–±–ª–æ–Ω –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–æ–≤
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –ø–æ–ª—è –∏–∑ —à–∞–±–ª–æ–Ω–∞ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ `TemplateData`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
4. –î–ª—è Word: —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å docxtemplater
5. –î–ª—è Excel: —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å `${variable}` –∏–ª–∏ `${table:arrayName}`
