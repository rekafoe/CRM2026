# Департаменты

Департаменты позволяют группировать пользователей и фильтровать заказы и отчёты по подразделениям.

## Назначение

- **Пользователи:** у каждого пользователя может быть один департамент (или без департамента).
- **Заказы:** в списке заказов можно фильтровать по департаменту — отображаются заказы, созданные пользователями выбранного департамента.
- **Заработок и отчёты:** на странице «Заработок» (админ) и в аналитике «Эффективность менеджеров» доступен фильтр по департаменту.

## Управление департаментами

- **Настройки → Департаменты:** создание, редактирование и удаление департаментов (доступно администраторам).
- Поля департамента: название, описание (необязательно), порядок сортировки.

## Назначение департамента пользователю

- **Настройки → Пользователи:** при создании или редактировании пользователя в форме есть поле «Департамент» (выбор из списка или «Без департамента»).
- В списке пользователей отображается департамент и доступен фильтр по департаменту.

## API

- `GET /api/departments` — список департаментов.
- `POST /api/departments` — создать департамент (admin).
- `PUT /api/departments/:id` — обновить департамент (admin).
- `DELETE /api/departments/:id` — удалить департамент (admin); у пользователей этого департамента поле `department_id` станет `NULL`.

В ответах `GET /api/users/all` у каждого пользователя есть поля `department_id` и `department_name`. В теле `POST /api/users` и `PUT /api/users/:id` можно передавать `department_id` (число или `null`).

## Фильтрация по департаменту

- **Заказы:** `GET /api/orders/search?department_id=<id>` — заказы, созданные пользователями указанного департамента.
- **Заработок (админ):** `GET /api/earnings/admin?month=...&department_id=<id>` — сводка только по пользователям департамента.
- **Аналитика менеджеров:** `GET /api/reports/analytics/managers/efficiency?period=30&department_id=<id>` — эффективность менеджеров выбранного департамента.
